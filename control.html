<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>3PT Control</title>
<style>
body{background:#111;color:white;font-family:Arial;padding:30px;}
button{padding:10px 18px;margin:6px;border:none;border-radius:8px;cursor:pointer;font-weight:bold;}
.make{background:#22c55e;}
.make2{background:gold;color:black;}
.miss{background:#ef4444;}
.start{background:#2563eb;color:white;}
.pause{background:#aaa;}
.reset{background:#ddd;}
input,select{padding:6px;margin:6px 0;}
.timer{font-size:24px;margin-top:15px;}
</style>
</head>
<body>

<h2>3PT Control</h2>

<input id="player" placeholder="Player Name"><br>

<label>Round Time (seconds)</label><br>
<input type="number" id="roundTime" value="70"><br>

<label>Money Rack</label><br>
<select id="moneyRack">
<option value="0">Rack 1</option>
<option value="1">Rack 2</option>
<option value="2" selected>Rack 3</option>
<option value="3">Rack 4</option>
<option value="4">Rack 5</option>
</select>

<br><br>

<button class="start" onclick="start()">Start</button>
<button class="pause" onclick="pause()">Pause</button>
<button class="reset" onclick="resetRound()">Reset</button>

<br><br>

<button class="make" onclick="shot('made')">MAKE</button>
<button class="make2" onclick="shot('made',2)">MAKE +2</button>
<button class="miss" onclick="shot('miss')">MISS</button>

<div class="timer" id="timerDisplay">70.0</div>

<script>
function getState(){
return JSON.parse(localStorage.getItem("threePTState")) || {
player:"PLAYER",
score:0,
timeLeft:70000,
roundTime:70000,
running:false,
rackIndex:0,
ballIndex:0,
moneyRack:2,
balls:Array.from({length:5},()=>Array.from({length:5},()=>null))
};
}

function saveState(s){
localStorage.setItem("threePTState",JSON.stringify(s));
}

document.getElementById("player").addEventListener("input",function(){
let s=getState();
s.player=this.value;
saveState(s);
});

document.getElementById("roundTime").addEventListener("change",function(){
let s=getState();
s.roundTime=parseInt(this.value)*1000;
s.timeLeft=s.roundTime;
saveState(s);
});

document.getElementById("moneyRack").addEventListener("change",function(){
let s=getState();
s.moneyRack=parseInt(this.value);
saveState(s);
});

function start(){let s=getState();s.running=true;saveState(s);}
function pause(){let s=getState();s.running=false;saveState(s);}

function resetRound(){
let s=getState();
s.score=0;
s.timeLeft=s.roundTime;
s.running=false;
s.rackIndex=0;
s.ballIndex=0;
s.balls=Array.from({length:5},()=>Array.from({length:5},()=>null));
saveState(s);
}

function shot(type,force=null){
let s=getState();
let r=s.rackIndex,b=s.ballIndex;
if(r>4)return;
if(s.balls[r][b]!=null)return;

s.balls[r][b]=type;

if(type==="made"){
let pts=force!=null?force:(r===s.moneyRack||b===4?2:1);
s.score+=pts;
}

s.ballIndex++;
if(s.ballIndex>4){
s.ballIndex=0;
s.rackIndex++;
}

saveState(s);
}

setInterval(()=>{
let s=getState();
document.getElementById("timerDisplay").textContent=(s.timeLeft/1000).toFixed(1);
},100);
</script>
</body>
</html>
