<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>3PT Overlay (3-ball racks + 2 logo)</title>
<style>
  body{margin:0;background:transparent;font-family:Arial, Helvetica, sans-serif;color:white;}

  .wrap{
    position:absolute;
    left:40px;
    bottom:40px;
    background:#111;
    padding:20px;
    border-radius:14px;
    box-shadow:0 10px 40px rgba(0,0,0,.6);
    overflow:hidden;
    transition:width .5s ease;
  }

  .top{display:flex;gap:20px;margin-bottom:18px;}
  .box{background:#1a1a1a;padding:14px 22px;border-radius:10px;}
  .label{font-size:12px;opacity:.6;text-transform:uppercase;}
  .big{font-size:30px;font-weight:800;}

  .sections{display:flex;gap:16px;}

  .section{
    width:170px;
    padding:12px;
    border-radius:12px;
    background:#1a1a1a;
    opacity:0;
    transform:translateY(10px);
    transition:all .35s ease;
  }
  .section.visible{opacity:1;transform:translateY(0);}
  .section.active{outline:3px solid #3b82f6; transform:translateY(0) scale(1.05);}
  .section.logo{outline:2px solid #ef4444;} /* red outline for logo (inactive) */
  .section.logo.active{outline:3px solid #3b82f6;} /* active stays BLUE */

  .title{font-size:12px;margin-bottom:8px;text-transform:uppercase;opacity:.75;letter-spacing:.5px;}
  .dots{display:flex;gap:10px;align-items:center;}

  .dot{
    width:20px;height:20px;border-radius:50%;
    background:#333;
    box-sizing:border-box;
  }
  .dot.money{border:3px solid gold;} /* rack money ball (3rd ball) */
  .dot.logoDot{border:2px solid #ef4444;} /* logo ball identity (inactive) */
  .dot.made{background:#22c55e;border-color:transparent;}
  .dot.miss{background:#ef4444;border-color:transparent;}
  .dot.made.logoDot{background:#22c55e;border:2px solid #ef4444;} /* keep logo identity */
  .dot.miss.logoDot{background:#ef4444;border:2px solid #ef4444;}
</style>
</head>
<body>

<div class="wrap" id="wrap">
  <div class="top">
    <div class="box">
      <div class="label">Shooter</div>
      <div class="big" id="player">PLAYER</div>
    </div>
    <div class="box">
      <div class="label">Score</div>
      <div class="big" id="score">0</div>
    </div>
    <div class="box">
      <div class="label">Time</div>
      <div class="big" id="time">70.0</div>
    </div>
  </div>

  <div class="sections" id="sections"></div>
</div>

<script>
  // 7 sections: rack, rack, logo, rack, logo, rack, rack
  const SECTIONS = [
    { type:"rack", label:"CORNER", balls:3 },
    { type:"rack", label:"WING",   balls:3 },
    { type:"logo", label:"LOGO",   balls:1 },
    { type:"rack", label:"TOP KEY",balls:3 },
    { type:"logo", label:"LOGO",   balls:1 },
    { type:"rack", label:"WING",   balls:3 },
    { type:"rack", label:"CORNER", balls:3 },
  ];

  function defaultState(){
    return {
      player:"PLAYER",
      score:0,
      timeLeft:70000,
      roundTime:70000,
      running:false,
      sectionIndex:0,   // 0..6
      ballIndex:0,      // within current section
      shots: SECTIONS.map(s => Array.from({length:s.balls}, ()=> null)) // "made" | "miss" | null
    };
  }

  function getState(){
    return JSON.parse(localStorage.getItem("threePTStateV2")) || defaultState();
  }

  function setState(s){
    localStorage.setItem("threePTStateV2", JSON.stringify(s));
  }

  function render(){
    const s = getState();

    document.getElementById("player").textContent = s.player || "PLAYER";
    document.getElementById("score").textContent  = s.score ?? 0;
    document.getElementById("time").textContent   = (s.timeLeft/1000).toFixed(1);

    const container = document.getElementById("sections");
    container.innerHTML = "";

    // show only sections up to current (sliding reveal style)
    for(let i=0;i<SECTIONS.length;i++){
      const meta = SECTIONS[i];

      const sec = document.createElement("div");
      sec.className = "section";

      if(i <= s.sectionIndex) sec.classList.add("visible");
      if(i === s.sectionIndex) sec.classList.add("active");
      if(meta.type === "logo") sec.classList.add("logo");

      const title = document.createElement("div");
      title.className = "title";
      title.textContent = meta.label;
      sec.appendChild(title);

      const dots = document.createElement("div");
      dots.className = "dots";

      for(let b=0;b<meta.balls;b++){
        const d = document.createElement("div");
        d.className = "dot";

        // Rack money ball is always the 3rd ball (index 2)
        if(meta.type==="rack" && b===2) d.classList.add("money");

        // Logo ball identity (red outline)
        if(meta.type==="logo") d.classList.add("logoDot");

        const shot = s.shots?.[i]?.[b] ?? null;
        if(shot==="made") d.classList.add("made");
        if(shot==="miss") d.classList.add("miss");

        dots.appendChild(d);
      }

      sec.appendChild(dots);
      container.appendChild(sec);
    }

    // width growth (your stable method)
    const wrap = document.getElementById("wrap");
    let baseWidth = 290;   // scoreboard area
    let sectionWidth = 185; // per visible section
    wrap.style.width = baseWidth + ((s.sectionIndex + 1) * sectionWidth) + "px";
  }

  // timer tick (localStorage version)
  setInterval(()=>{
    const s = getState();
    if(s.running && s.timeLeft > 0){
      s.timeLeft = Math.max(0, s.timeLeft - 100);
      setState(s);
    }
    render();
  }, 100);

  render();
</script>
</body>
</html>
